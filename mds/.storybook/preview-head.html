<script>
  setTimeout(function () {
    function addCSSClassesToBodyTagForMDSDocs() {
      // Add extra classes when embedded in the MDS website
      const mdsDocsTheme = urlParams.get('mdsdocstheme') || 'none';
      const mdsDocsFullscreen = urlParams.get('mdsdocsfullscreen');
      document.body.classList.add('mdsdocs');
      document.body.classList.add(`mdsdocs-${mdsDocsTheme}`);
      if (mdsDocsFullscreen == 'true') {
        document.body.classList.add('mdsdocs-fullscreen');
      }
    }

    // Check if "mdsdocs" query parameter exists
    const urlParams = new URLSearchParams(window.location.search);
    const isMDSDocsiFrame = urlParams.get('mdsdocs');
    if (isMDSDocsiFrame !== 'true') return;

    let domContentLoadedCount = 0;
    window.document.addEventListener('DOMContentLoaded', () => {
      domContentLoadedCount++;
      if (domContentLoadedCount > 1) {
        addCSSClassesToBodyTagForMDSDocs();

        const rootInnerEl = document.getElementById('root-inner');
        if (!rootInnerEl) return;

        // Remove any story notifications
        const storyNotifications = rootInnerEl.querySelectorAll('.story-notification');
        storyNotifications.forEach((notification) => {
          notification.parentNode.removeChild(notification);
        });

        // Post a message back to the MDS website to say the story has
        // loaded and what the estimated height will be so the MDS website
        // can show and resize the iFrame
        window.setTimeout(() => {
          const uuid = urlParams.get('mdsdocsuuid') || '';
          let showCode = localStorage.getItem('mds-sb-show-code') || 'false';
          window.parent.postMessage(
            { key: 'loaded', height: rootInnerEl.clientHeight, uuid: uuid, showCode: showCode },
            { targetOrigin: '*' },
          );
        }, 100);
      }
    });
  }, 0);
</script>
