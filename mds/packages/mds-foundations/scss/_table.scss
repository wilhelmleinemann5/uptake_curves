@import './mixins/_typography';
@import './mixins/_table';

mc-c-table {
  display: block;
}

.mds-table {
  --row-border-radius: calc(var(--mds_foundations_table_border-radius) - 1px);

  border-radius: var(--mds_foundations_table_border-radius);
  border: var(--mds_foundations_table_border-width) var(--mds_foundations_table_border-style)
    var(--mds_foundations_table_border-color);
  max-width: 100%;

  table {
    border-collapse: collapse;
    border-style: hidden;
    width: 100%;
    border-radius: var(--mds_foundations_table_border-radius);
  }

  /** Base cell styles **/
  th,
  td {
    padding: var(--mds_foundations_table_medium_cell_padding-top) var(--mds_foundations_table_medium_cell_padding-right)
      var(--mds_foundations_table_medium_cell_padding-bottom) var(--mds_foundations_table_medium_cell_padding-left);
    text-align: left;
    vertical-align: middle;
    border: 0;
    border-bottom: var(--mds_foundations_table_border-width) var(--mds_foundations_table_border-style)
      var(--mds_foundations_table_border-color);

    .mds-table__subtext {
      color: var(--mds_foundations_table_subtext_text-color);
      display: block;
      font-weight: var(--mds_foundations_table_subtext_font-weight);
      @include mds-apply-font('text', 'small', 'normal');
    }
  }

  /** Header cell styles **/
  th {
    background-color: var(--mds_foundations_table_header-cell_background-color);
    color: var(--mds_foundations_table_header-cell_text-color);
    @include mds-apply-font('text', 'medium', 'bold');
  }

  /** Data cell styles **/
  td {
    background-color: var(--mds_foundations_table_cell_background-color);
    color: var(--mds_foundations_table_cell_text-color);
    @include mds-apply-font('text', 'medium', 'normal');
  }

  /** Footer cell styles **/
  tfoot td {
    background-color: var(--mds_foundations_table_cell_background-color);
    color: var(--mds_foundations_table_cell_text-color);
    @include mds-apply-font('text', 'medium', 'bold');
  }

  /** Cell positioning **/
  thead tr th,
  tbody tr td,
  tbody tr th,
  tfoot tr td {
    position: relative;
  }

  /** Large fit **/
  &.mds-table--large {
    th,
    td {
      padding: var(--mds_foundations_table_large_cell_padding-top) var(--mds_foundations_table_large_cell_padding-right)
        var(--mds_foundations_table_large_cell_padding-bottom) var(--mds_foundations_table_large_cell_padding-left);
    }

    .mds-table__row-selector > mc-checkbox {
      margin-top: 0;
    }

    .mds-table__row-expander > mc-button {
      margin-top: 0;
    }

    .mds-table__header-cell--sortable {
      padding-top: var(--mds_foundations_table_large_header-cell_sortable_padding-top);
      padding-bottom: var(--mds_foundations_table_large_header-cell_sortable_padding-bottom);
    }

    @include mds-apply-expanded-row-padding('large');
  }

  /** Small fit **/
  &.mds-table--small {
    th {
      @include mds-apply-font('text', 'small', 'bold');
    }

    td {
      @include mds-apply-font('text', 'small', 'normal');
    }

    th,
    td {
      padding: var(--mds_foundations_table_small_cell_padding-top) var(--mds_foundations_table_small_cell_padding-right)
        var(--mds_foundations_table_small_cell_padding-bottom) var(--mds_foundations_table_small_cell_padding-left);

      .mds-table__subtext {
        @include mds-apply-font('text', 'x-small', 'normal');
      }
    }

    tfoot td {
      @include mds-apply-font('text', 'small', 'bold');
    }

    .mds-table__header-cell--sortable {
      padding-top: var(--mds_foundations_table_small_header-cell_sortable_padding-top);
      padding-bottom: var(--mds_foundations_table_small_header-cell_sortable_padding-bottom);
    }

    @include mds-apply-expanded-row-padding('small');
  }

  /** Zebra stripes **/

  &.mds-table--zebra-stripes {
    tbody tr:nth-child(even) td {
      background-color: var(--mds_foundations_table_zebra-stripe_background-color);
      color: var(--mds_foundations_table_zebra-stripe_text-color);
    }
  }

  &.mds-table--zebra-stripes:not(.mds-table--disable-row-highlight-on-hover) tbody tr {
    &:nth-child(even) td {
      background-color: var(--mds_foundations_table_zebra-stripe_background-color);
      color: var(--mds_foundations_table_zebra-stripe_text-color);
    }

    &:nth-child(odd) td {
      background-color: var(--mds_foundations_table_cell_background-color);
      color: var(--mds_foundations_table_cell_text-color);
    }
  }

  &.mds-table--zebra-stripes-with-expand {
    /* Use row pairs (main row + expanded row) for zebra striping */
    tbody > tr:nth-child(4n + 1),
    tbody > tr:nth-child(4n + 2) {
      td {
        background-color: var(--mds_foundations_table_cell_background-color);
        color: var(--mds_foundations_table_cell_text-color);
      }
    }

    tbody > tr:nth-child(4n + 3),
    tbody > tr:nth-child(4n + 4) {
      td {
        background-color: var(--mds_foundations_table_zebra-stripe_background-color);
        color: var(--mds_foundations_table_zebra-stripe_text-color);
      }
    }
  }

  &.mds-table--zebra-stripes-with-expand:not(.mds-table--disable-row-highlight-on-hover) {
    /* Use row pairs (main row + expanded row) for zebra striping */
    tbody > tr:nth-child(4n + 1),
    tbody > tr:nth-child(4n + 2) {
      td {
        background-color: var(--mds_foundations_table_cell_background-color);
        color: var(--mds_foundations_table_cell_text-color);
      }
    }

    tbody > tr:nth-child(4n + 3),
    tbody > tr:nth-child(4n + 4) {
      td {
        background-color: var(--mds_foundations_table_zebra-stripe_background-color);
        color: var(--mds_foundations_table_zebra-stripe_text-color);
      }
    }
  }

  /** Highlight on hover **/
  &:not(.mds-table--disable-row-highlight-on-hover) tbody tr {
    &:nth-child(even):hover,
    &:nth-child(odd):hover {
      td {
        background-color: var(--mds_foundations_table_cell_hover_background-color);
        color: var(--mds_foundations_table_cell_hover_text-color);
      }
    }
  }

  // Add border radius to corner cells
  thead tr:first-child {
    th:first-child,
    td:first-child {
      border-top-left-radius: calc(var(--mds_foundations_table_border-radius) - 1px);
    }

    th:last-child,
    td:last-child {
      border-top-right-radius: calc(var(--mds_foundations_table_border-radius) - 1px);
    }
  }

  tbody:last-child tr:last-child,
  tfoot tr:last-child {
    td:first-child,
    th:first-child {
      border-bottom-left-radius: calc(var(--mds_foundations_table_border-radius) - 1px);
    }

    td:last-child,
    th:last-child {
      border-bottom-right-radius: calc(var(--mds_foundations_table_border-radius) - 1px);
    }
  }

  /** Border style variations **/
  &.mds-table--horizontal-lines-dashed {
    th,
    td {
      border-bottom-style: dashed;
    }

    thead th,
    thead td {
      border-top-style: dashed;
    }
  }

  &.mds-table--horizontal-lines-dotted {
    th,
    td {
      border-bottom-style: dotted;
    }

    thead th,
    thead td {
      border-top-style: dotted;
    }
  }

  &.mds-table--vertical-lines-solid {
    th,
    td {
      border-left: var(--mds_foundations_table_border-width) solid var(--mds_foundations_table_border-color);
      border-right: var(--mds_foundations_table_border-width) solid var(--mds_foundations_table_border-color);
    }
  }

  &.mds-table--vertical-lines-dashed {
    th,
    td {
      border-left: var(--mds_foundations_table_border-width) dashed var(--mds_foundations_table_border-color);
      border-right: var(--mds_foundations_table_border-width) dashed var(--mds_foundations_table_border-color);
    }
  }

  &.mds-table--vertical-lines-dotted {
    th,
    td {
      border-left: var(--mds_foundations_table_border-width) dotted var(--mds_foundations_table_border-color);
      border-right: var(--mds_foundations_table_border-width) dotted var(--mds_foundations_table_border-color);
    }
  }

  &.mds-table--horizontal-lines-none {
    th,
    td {
      border-top-width: 0;
      border-bottom-width: 0;
    }
  }

  &.mds-table--vertical-lines-none {
    th,
    td {
      border-left-width: 0;
      border-right-width: 0;
    }
  }

  &.mds-table--outer-border-none {
    border-width: 0;
  }

  &.mds-table--outer-border-dashed {
    border-style: dashed;
  }

  &.mds-table--outer-border-dotted {
    border-style: dotted;
  }

  &.mds-table--outer-border-corners-square {
    border-radius: 0;

    thead tr:first-child,
    tbody:last-child tr:last-child,
    tfoot tr:last-child {
      th,
      td {
        border-radius: 0;
      }
    }
  }

  // Reset radius for nested tables
  table tr th,
  table tr td {
    border-radius: 0;
  }

  /** Wrapping **/
  &.mds-table--nowrap {
    white-space: nowrap;

    * {
      white-space: nowrap;
    }
  }

  .mds-table__cell--nowrap {
    white-space: nowrap;

    * {
      white-space: nowrap;
    }
  }

  /** Vertical alignment **/
  &.mds-table--vertical-align-top {
    td,
    th {
      vertical-align: top;
    }
  }

  &.mds-table--vertical-align-baseline {
    td,
    th {
      vertical-align: baseline;
    }
  }

  &.mds-table--vertical-align-bottom {
    td,
    th {
      vertical-align: bottom;
    }
  }

  /** Row selector **/
  .mds-table__column--row-selector {
    @include mds-apply-row-controls-styles();
  }

  .mds_table__row--selected {
    td {
      background-color: var(--mds_foundations_table_cell_selected_background-color);
      color: var(--mds_foundations_table_cell_selected_text-color);
    }
  }

  /** Row expander **/
  .mds-table__column--row-expander {
    @include mds-apply-row-controls-styles();
  }

  /** Sortable header **/
  .mds-table__header-cell--sortable {
    cursor: pointer;
    user-select: none !important;
    padding-top: var(--mds_foundations_table_medium_header-cell_sortable_padding-top);
    padding-bottom: var(--mds_foundations_table_medium_header-cell_sortable_padding-bottom);

    &:hover {
      background-color: var(--mds_foundations_table_header-cell_sort_hover_background-color);
    }

    &:active {
      background-color: var(--mds_foundations_table_header-cell_sort_active_background-color);
    }

    mc-button {
      pointer-events: none;
    }

    mc-button::part(button) {
      border-radius: 0;
      padding: 0;
    }

    mc-button::part(text-and-icon) {
      font-weight: var(--mds_foundations_table_header-cell_sort-button_font-weight);
    }
  }

  /** Scrollable **/
  &.mds-table--scrollable {
    overflow: auto;

    // Remove rounded corners from cells that would be affected by scrollbar
    thead tr:first-child {
      th:last-child,
      td:last-child {
        border-top-right-radius: 0;
      }
    }

    tbody:last-child tr:last-child,
    tfoot tr:last-child {
      td:last-child,
      th:last-child {
        border-bottom-right-radius: 0;
      }
    }
  }

  /** No header **/
  &.mds-table--header-none {
    thead {
      display: none;
    }

    tbody tr:first-child > *:first-child {
      border-top-left-radius: var(--row-border-radius);
    }

    tbody tr:first-child > *:last-child {
      border-top-right-radius: var(--row-border-radius);
    }
  }

  /** Footer **/
  &.mds-table--footer {
    tbody tr:last-child > *:first-child {
      border-bottom-left-radius: 0;
    }

    tbody tr:last-child > *:last-child {
      border-bottom-right-radius: 0;
    }

    tfoot tr:first-child td,
    tfoot tr:first-child th {
      border-top: var(--mds_foundations_table_border-width) var(--mds_foundations_table_border-style)
        var(--mds_foundations_table_border-color);
    }
  }

  /** Sticky **/
  .mds-table__column--sticky {
    left: 0;
    position: sticky;
    z-index: 10;
    box-shadow: inset calc(0px - var(--mds_core_table_sticky-column_border-width, 3px)) 0 0 0
      var(--mds_foundations_table_border-color);
  }

  &.mds-table--header-sticky {
    thead tr th {
      border-bottom: 0;
      box-shadow: inset 0 -1px var(--mds_foundations_table_border-color);
    }

    thead th,
    thead td {
      top: 0;
      position: sticky;
      z-index: 11;
    }

    thead th.mds-table__column--sticky,
    thead td.mds-table__column--sticky {
      z-index: 12;
    }
  }

  &.mds-table--footer-sticky {
    tbody tr:last-child td,
    tbody tr:last-child th {
      border-bottom: 0;
    }

    tfoot tr:first-child td,
    tfoot tr:first-child th {
      border-top: 0;
    }

    tfoot tr td,
    tfoot tr th {
      box-shadow: inset 0 1px var(--mds_foundations_table_border-color);
    }

    tfoot td,
    tfoot th {
      bottom: 0;
      position: sticky;
      z-index: 11;
    }

    tfoot th.mds-table__column--sticky,
    tfoot td.mds-table__column--sticky {
      z-index: 12;
    }
  }

  th.mds-table__cell--text-center,
  td.mds-table__cell--text-center {
    text-align: center;
  }

  th.mds-table__cell--text-right,
  td.mds-table__cell--text-right {
    text-align: right;
  }

  th.mds-table__cell--tabular-figures,
  td.mds-table__cell--tabular-figures {
    font-feature-settings: 'tnum';
  }

  th.mds-table__cell--number,
  td.mds-table__cell--number {
    @extend .mds-table__cell--text-right;
    @extend .mds-table__cell--tabular-figures;
  }

  th.mds-table__cell--content-top,
  td.mds-table__cell--content-top {
    vertical-align: top;
  }

  th.mds-table__cell--content-center,
  td.mds-table__cell--content-center {
    vertical-align: middle;
  }

  th.mds-table__cell--content-bottom,
  td.mds-table__cell--content-bottom {
    vertical-align: bottom;
  }

  /** exapnded row **/
  .mds-table__expanded-row {
    &--hidden {
      display: none;
    }

    &--visible {
      display: table-row;

      &:last-of-type {
        border-top: var(--mds_foundations_table_border-width) var(--mds_foundations_table_border-style)
          var(--mds_foundations_table_border-color);
      }
    }
  }

  &.mds-table--medium {
    @include mds-apply-expanded-row-padding('medium');
  }

  .mds-table__expanded-row__trigger {
    &::part(button) {
      margin: 0;
      width: auto;

      &:hover {
        background-color: transparent;
      }
    }

    &::part(icon) {
      transition: transform var(--mds_foundations_table_row-expander-trigger_transition-duration) ease-in-out;
    }

    &--expanded {
      &::part(icon) {
        transform: rotate(-180deg);
      }
    }
  }
}

/** Table with caption **/
.mds-table-and-caption {
  margin: var(--mds_foundations_table_margin-top) 0 var(--mds_foundations_table_margin-top);

  .mds-table {
    margin: 0;
  }
}

/** Caption **/
.mds-table-caption {
  color: var(--mds_foundations_table_caption_text-color);
  margin-bottom: var(--mds_foundations_table_medium_caption_margin-bottom);

  &.mds-table-caption--small {
    margin-bottom: var(--mds_foundations_table_small_caption_margin-bottom);

    @include mds-apply-font('text', 'small', 'normal');
  }

  &.mds-table-caption--large {
    margin-bottom: var(--mds_foundations_table_large_caption_margin-bottom);
  }

  @include mds-apply-font('text', 'medium', 'normal');
}
