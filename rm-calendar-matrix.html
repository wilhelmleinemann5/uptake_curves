<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E1-W: Calendar Operating Window (W47‚ÄìW52 2025)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --maersk-blue: #42B0D5;
            --maersk-dark: #003B5C;
            --neutral-900: #1a1a2e;
            --neutral-800: #242438;
            --neutral-700: #2d2d44;
            --neutral-600: #3d3d5c;
            --neutral-500: #5a5a7a;
            --neutral-400: #8888a8;
            --neutral-300: #aaaac8;
            --neutral-200: #d0d0e0;
            --neutral-100: #f0f0f8;
            
            /* Capacity tightness colors */
            --capacity-1: rgba(66, 176, 213, 0.12);
            --capacity-2: rgba(66, 176, 213, 0.25);
            --capacity-3: rgba(66, 176, 213, 0.42);
            --capacity-4: rgba(255, 140, 66, 0.50);
            
            /* Event colors */
            --event-spike: rgba(255, 193, 7, 0.18);
            --event-spike-border: rgba(255, 193, 7, 0.6);
            --event-removal: rgba(220, 53, 69, 0.18);
            --event-removal-border: rgba(220, 53, 69, 0.6);
            
            /* Halo/ripple colors */
            --halo-spike-strong: rgba(255, 193, 7, 0.12);
            --halo-spike-light: rgba(255, 193, 7, 0.05);
            --halo-removal-strong: rgba(220, 53, 69, 0.12);
            --halo-removal-light: rgba(220, 53, 69, 0.05);
            
            /* Column tint colors */
            --col-tint-spike: rgba(255, 193, 7, 0.06);
            --col-tint-removal: rgba(220, 53, 69, 0.06);
            
            /* Grid dimensions */
            --cell-width: 138px;
            --cell-height: 100px;
            --cell-gap: 5px;
            --row-label-width: 75px;
            --wtd-label-width: 45px;
        }
        
        body {
            font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--neutral-900);
            color: var(--neutral-100);
            min-height: 100vh;
            padding: 0;
        }
        
        .frame {
            width: 1920px;
            height: 1080px;
            background: linear-gradient(145deg, var(--neutral-900) 0%, #0f0f1a 100%);
            padding: 32px 40px;
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        .header {
            margin-bottom: 20px;
        }
        
        .title {
            font-size: 26px;
            font-weight: 700;
            color: var(--neutral-100);
            margin-bottom: 6px;
            letter-spacing: -0.5px;
        }
        
        .title span {
            color: var(--maersk-blue);
        }
        
        .subtitle {
            font-size: 12px;
            color: var(--neutral-400);
            max-width: 800px;
            line-height: 1.5;
        }
        
        /* Main layout */
        .main-layout {
            display: flex;
            gap: 24px;
            flex: 1;
        }
        
        /* Matrix container */
        .matrix-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        /* Column headers row */
        .header-row {
            display: grid;
            grid-template-columns: var(--wtd-label-width) var(--row-label-width) repeat(6, var(--cell-width));
            gap: var(--cell-gap);
            margin-bottom: 3px;
        }
        
        .header-spacer {
            /* Empty space for WTD and row labels */
        }
        
        .column-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px 0;
            position: relative;
        }
        
        .week-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--neutral-200);
        }
        
        .event-tag {
            font-size: 8px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 8px;
            margin-top: 3px;
            white-space: nowrap;
        }
        
        .event-tag.spike {
            background: rgba(255, 193, 7, 0.25);
            color: #fcd34d;
            border: 1px solid var(--event-spike-border);
        }
        
        .event-tag.removal {
            background: rgba(220, 53, 69, 0.25);
            color: #fca5a5;
            border: 1px solid var(--event-removal-border);
        }
        
        /* Matrix grid */
        .matrix-grid {
            display: flex;
            flex-direction: column;
            gap: 1px;
            position: relative;
        }
        
        /* WTD cluster group */
        .wtd-group {
            display: flex;
            flex-direction: column;
            gap: var(--cell-gap);
            position: relative;
            padding: 6px 0;
            margin-bottom: 2px;
        }
        
        .wtd-group::before {
            content: attr(data-wtd);
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
            font-size: 9px;
            font-weight: 600;
            color: var(--maersk-blue);
            letter-spacing: 0.5px;
            white-space: nowrap;
            width: var(--wtd-label-width);
            text-align: center;
        }
        
        .wtd-group::after {
            content: '';
            position: absolute;
            left: 34px;
            top: 6px;
            bottom: 6px;
            width: 2px;
            background: var(--maersk-blue);
            opacity: 0.3;
            border-radius: 1px;
        }
        
        /* Matrix row */
        .matrix-row {
            display: grid;
            grid-template-columns: var(--wtd-label-width) var(--row-label-width) repeat(6, var(--cell-width));
            gap: var(--cell-gap);
            position: relative;
        }
        
        /* Row label */
        .row-label {
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-left: 6px;
        }
        
        .dep-id {
            font-size: 13px;
            font-weight: 600;
            color: var(--neutral-200);
        }
        
        .dep-etd {
            font-size: 9px;
            color: var(--neutral-500);
            margin-top: 1px;
        }
        
        /* Matrix cell */
        .matrix-cell {
            height: var(--cell-height);
            border-radius: 5px;
            padding: 6px 8px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255,255,255,0.04);
            transition: all 0.15s ease;
            position: relative;
            font-family: 'IBM Plex Sans', sans-serif;
        }
        
        .matrix-cell:hover {
            border-color: var(--maersk-blue);
            transform: scale(1.02);
            z-index: 10;
        }
        
        .matrix-cell.capacity-1 { background: var(--capacity-1); }
        .matrix-cell.capacity-2 { background: var(--capacity-2); }
        .matrix-cell.capacity-3 { background: var(--capacity-3); }
        .matrix-cell.capacity-4 { background: var(--capacity-4); }
        
        .matrix-cell.inactive {
            background: rgba(255,255,255,0.02);
            opacity: 0.30;
        }
        
        .matrix-cell.inactive .cell-metrics,
        .matrix-cell.inactive .cell-yields {
            opacity: 0.5;
        }
        
        /* Event column highlights */
        .matrix-cell.event-spike-col {
            box-shadow: inset 0 0 0 2px var(--event-spike-border);
        }
        
        .matrix-cell.event-removal-col {
            box-shadow: inset 0 0 0 2px var(--event-removal-border);
        }
        
        /* Cell header - Bookings delta */
        .cell-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
            padding-bottom: 3px;
            border-bottom: 1px solid rgba(255,255,255,0.06);
        }
        
        .bookings-delta {
            font-size: 13px;
            font-weight: 700;
        }
        
        .bookings-delta.positive { color: #4ade80; }
        .bookings-delta.negative { color: #f87171; }
        .bookings-delta.neutral { color: var(--neutral-500); }
        
        .remaining-ffe {
            font-size: 9px;
            color: var(--neutral-300);
            font-weight: 500;
        }
        
        .remaining-ffe span {
            font-weight: 700;
            color: var(--neutral-100);
        }
        
        /* Cell metrics - Capacity info */
        .cell-metrics {
            display: flex;
            gap: 4px;
            margin-bottom: 4px;
            flex-wrap: wrap;
        }
        
        .metric {
            font-size: 8px;
            color: var(--neutral-400);
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .metric-label {
            text-transform: uppercase;
            letter-spacing: 0.3px;
            opacity: 0.8;
        }
        
        .metric-value {
            font-weight: 600;
            color: var(--neutral-300);
            font-family: 'IBM Plex Mono', monospace;
            font-size: 9px;
        }
        
        .metric.onp .metric-value { color: #ef4444; }
        .metric.cpm .metric-value { color: #06b6d4; }
        
        /* Cell yields - CY/FFE */
        .cell-yields {
            display: flex;
            gap: 6px;
            margin-bottom: 4px;
        }
        
        .yield {
            font-size: 8px;
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .yield-label {
            color: var(--neutral-500);
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }
        
        .yield-value {
            font-weight: 600;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 9px;
        }
        
        .yield.utm .yield-value { color: #8b5cf6; }
        .yield.sp .yield-value { color: #3b82f6; }
        
        /* Cell bottom - Persona badges */
        .cell-bottom {
            display: flex;
            gap: 2px;
            flex-wrap: wrap;
            margin-top: auto;
        }
        
        /* Persona badges */
        .persona-badge {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6px;
            font-weight: 700;
            letter-spacing: -0.3px;
        }
        
        .persona-badge.sp { background: #3b82f6; color: white; }
        .persona-badge.u { background: #8b5cf6; color: white; }
        .persona-badge.cpm { background: #06b6d4; color: white; }
        .persona-badge.mm { background: #f59e0b; color: white; }
        .persona-badge.onp { background: #ef4444; color: white; }
        
        /* Sailed state */
        .matrix-cell.inactive .cell-header {
            border-bottom: none;
        }
        
        .sailed-label {
            font-size: 10px;
            color: var(--neutral-500);
            text-align: center;
            margin: auto;
        }
        
        /* ========================================
           MODE TOGGLE & PROGRESSIVE DISCLOSURE
           ======================================== */
        
        .mode-toggle {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
        }
        
        .mode-btn {
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
            color: var(--neutral-400);
            transition: all 0.15s ease;
        }
        
        .mode-btn:hover {
            background: rgba(255,255,255,0.1);
            color: var(--neutral-200);
        }
        
        .mode-btn.active {
            background: var(--maersk-blue);
            color: white;
            border-color: var(--maersk-blue);
        }
        
        /* Executive mode - hide detailed metrics */
        .frame.exec-mode .cell-metrics,
        .frame.exec-mode .cell-yields {
            display: none;
        }
        
        .frame.exec-mode .matrix-cell {
            --cell-height: 65px;
            height: 65px;
        }
        
        .frame.exec-mode .cell-header {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* Hover tooltip for detail mode */
        .matrix-cell .cell-tooltip {
            display: none;
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.95);
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 10px;
            white-space: nowrap;
            z-index: 100;
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        
        .frame.exec-mode .matrix-cell:hover .cell-tooltip {
            display: block;
        }
        
        .cell-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(0,0,0,0.95);
        }
        
        .tooltip-row {
            display: flex;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 4px;
        }
        
        .tooltip-row:last-child {
            margin-bottom: 0;
        }
        
        .tooltip-label {
            color: var(--neutral-500);
        }
        
        .tooltip-value {
            font-weight: 600;
            font-family: 'IBM Plex Mono', monospace;
        }
        
        .tooltip-value.onp { color: #ef4444; }
        .tooltip-value.cpm { color: #06b6d4; }
        .tooltip-value.utm { color: #8b5cf6; }
        .tooltip-value.sp { color: #3b82f6; }
        
        /* ========================================
           COLUMN TINTS (Vertical wash)
           ======================================== */
        
        .matrix-cell[data-col="w48"],
        .matrix-cell[data-col="w49"] {
            background-image: linear-gradient(to bottom, var(--col-tint-spike), var(--col-tint-spike));
            background-blend-mode: overlay;
        }
        
        .matrix-cell[data-col="w51"] {
            background-image: linear-gradient(to bottom, var(--col-tint-removal), var(--col-tint-removal));
            background-blend-mode: overlay;
        }
        
        /* ========================================
           HALO BANDS (Horizontal ripple effect)
           ======================================== */
        
        .wtd-group {
            position: relative;
        }
        
        .halo-band {
            position: absolute;
            top: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
            border-radius: 4px;
        }
        
        /* Spike halo - W48-W49 columns */
        .wtd-group[data-wtd="WTD 0‚Äì2"] .halo-spike,
        .wtd-group[data-wtd="WTD 2‚Äì4"] .halo-spike {
            left: calc(var(--wtd-label-width) + var(--row-label-width) + var(--cell-width) + var(--cell-gap));
            width: calc(var(--cell-width) * 2 + var(--cell-gap));
            background: var(--halo-spike-strong);
        }
        
        .wtd-group[data-wtd="WTD 5‚Äì8"] .halo-spike {
            left: calc(var(--wtd-label-width) + var(--row-label-width) + var(--cell-width) + var(--cell-gap));
            width: calc(var(--cell-width) * 2 + var(--cell-gap));
            background: var(--halo-spike-light);
        }
        
        /* Removal halo - W51 column */
        .wtd-group[data-wtd="WTD 2‚Äì4"] .halo-removal {
            left: calc(var(--wtd-label-width) + var(--row-label-width) + var(--cell-width) * 4 + var(--cell-gap) * 4);
            width: var(--cell-width);
            background: var(--halo-removal-strong);
        }
        
        .wtd-group[data-wtd="WTD 0‚Äì2"] .halo-removal,
        .wtd-group[data-wtd="WTD 5‚Äì8"] .halo-removal {
            left: calc(var(--wtd-label-width) + var(--row-label-width) + var(--cell-width) * 4 + var(--cell-gap) * 4);
            width: var(--cell-width);
            background: var(--halo-removal-light);
        }
        
        /* ========================================
           ROW/COLUMN HOVER HIGHLIGHT
           ======================================== */
        
        .matrix-row:hover .row-label {
            color: var(--neutral-100);
        }
        
        .matrix-row:hover .row-label .dep-id {
            color: var(--maersk-blue);
        }
        
        .matrix-row:hover .matrix-cell:not(:hover) {
            opacity: 0.7;
        }
        
        .matrix-row:hover .matrix-cell:hover {
            opacity: 1;
        }
        
        /* ========================================
           WEEKLY SUMMARY STRIP
           ======================================== */
        
        .weekly-summary {
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            padding: 14px;
            border: 1px solid rgba(255,255,255,0.06);
        }
        
        .weekly-summary-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--neutral-200);
            margin-bottom: 10px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .week-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        .week-stat {
            text-align: center;
            padding: 8px 4px;
            border-radius: 4px;
            background: rgba(255,255,255,0.03);
        }
        
        .week-stat.shock {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }
        
        .week-stat.removal {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }
        
        .week-stat-label {
            font-size: 9px;
            color: var(--neutral-500);
            margin-bottom: 4px;
        }
        
        .week-stat-value {
            font-size: 14px;
            font-weight: 700;
            color: var(--neutral-100);
        }
        
        .week-stat-sub {
            font-size: 8px;
            color: var(--neutral-400);
            margin-top: 2px;
        }
        
        .week-stat.shock .week-stat-value { color: #fcd34d; }
        .week-stat.removal .week-stat-value { color: #fca5a5; }
        
        /* WTD Note */
        .wtd-note {
            font-size: 9px;
            color: var(--neutral-500);
            font-style: italic;
            margin-top: 10px;
            padding: 6px 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 4px;
            line-height: 1.4;
        }
        
        /* Right panel */
        .right-panel {
            width: 240px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        /* Annotations */
        .annotation {
            background: rgba(0,0,0,0.5);
            padding: 12px 14px;
            border-radius: 6px;
            border-left: 3px solid var(--maersk-blue);
            font-size: 10px;
            line-height: 1.5;
            color: var(--neutral-300);
        }
        
        .annotation strong {
            color: var(--maersk-blue);
            display: block;
            margin-bottom: 3px;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .annotation.spike {
            border-left-color: #fcd34d;
        }
        
        .annotation.spike strong {
            color: #fcd34d;
        }
        
        .annotation.removal {
            border-left-color: #fca5a5;
        }
        
        .annotation.removal strong {
            color: #fca5a5;
        }
        
        /* Legend */
        .legend {
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            padding: 14px;
            border: 1px solid rgba(255,255,255,0.06);
            margin-top: auto;
        }
        
        .legend-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--neutral-200);
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .legend-section {
            margin-bottom: 10px;
        }
        
        .legend-section:last-child {
            margin-bottom: 0;
        }
        
        .legend-label {
            font-size: 8px;
            color: var(--neutral-500);
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .legend-items {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 9px;
            color: var(--neutral-300);
        }
        
        .legend-color {
            width: 16px;
            height: 10px;
            border-radius: 2px;
            flex-shrink: 0;
        }
        
        .legend-color.cap-1 { background: var(--capacity-1); border: 1px solid rgba(255,255,255,0.1); }
        .legend-color.cap-2 { background: var(--capacity-2); }
        .legend-color.cap-3 { background: var(--capacity-3); }
        .legend-color.cap-4 { background: var(--capacity-4); }
        .legend-color.event-spike { background: var(--event-spike); border: 1px solid var(--event-spike-border); }
        .legend-color.event-removal { background: var(--event-removal); border: 1px solid var(--event-removal-border); }
        
        .legend-badges {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }
        
        .legend-badge-item {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 8px;
            color: var(--neutral-400);
        }
        
        .legend-badge-item .persona-badge {
            width: 14px;
            height: 14px;
            font-size: 5px;
        }
        
        /* Token legend */
        .legend-tokens {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        
        .token-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 8px;
        }
        
        .token-owner {
            width: 28px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .token-owner.onp { color: #ef4444; }
        .token-owner.cpm { color: #06b6d4; }
        .token-owner.utm { color: #8b5cf6; }
        .token-owner.sp { color: #3b82f6; }
        .token-owner.joint { color: var(--neutral-300); }
        
        .token-desc {
            color: var(--neutral-400);
        }
        
        /* Responsive scaling */
        @media (max-width: 1920px) {
            body {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="frame exec-mode" id="mainFrame">
        <!-- Header -->
        <div class="header" style="display: flex; align-items: flex-start; gap: 20px;">
            <div>
                <h1 class="title"><span>E1-W:</span> Calendar Operating Window (W47‚ÄìW52 2025)</h1>
                <p class="subtitle">Weekly decisions + customer bookings land onto multiple future departures. Departures are coupled via customer substitution + operational reflow. Shocks create direct + halo effects.</p>
            </div>
            <div class="mode-toggle">
                <button class="mode-btn active" onclick="setMode('exec')">Executive</button>
                <button class="mode-btn" onclick="setMode('detail')">Detail</button>
            </div>
        </div>
        
        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Matrix Container -->
            <div class="matrix-container">
                <!-- Column Headers -->
                <div class="header-row">
                    <div class="header-spacer"></div>
                    <div class="header-spacer"></div>
                    <div class="column-header">
                        <span class="week-label">W47</span>
                    </div>
                    <div class="column-header">
                        <span class="week-label">W48</span>
                        <span class="event-tag spike">üìà Booking spike</span>
                    </div>
                    <div class="column-header">
                        <span class="week-label">W49</span>
                        <span class="event-tag spike">üìà (W48‚ÄìW49)</span>
                    </div>
                    <div class="column-header">
                        <span class="week-label">W50</span>
                    </div>
                    <div class="column-header">
                        <span class="week-label">W51</span>
                        <span class="event-tag removal">‚ö†Ô∏è Cap. removal</span>
                    </div>
                    <div class="column-header">
                        <span class="week-label">W52</span>
                    </div>
                </div>
                
                <!-- Matrix Grid -->
                <div class="matrix-grid">
                    <!-- WTD 0-2 Group -->
                    <div class="wtd-group" data-wtd="WTD 0‚Äì2">
                        <!-- Halo bands for ripple effect -->
                        <div class="halo-band halo-spike"></div>
                        <div class="halo-band halo-removal"></div>
                        <!-- D1 Row (Vessel: 380 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D1</span>
                                <span class="dep-etd">ETD W48</span>
                            </div>
                            <div class="matrix-cell capacity-2">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+5%</span>
                                    <span class="remaining-ffe">Rem <span>180</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$820</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$890</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-4 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+22%</span>
                                    <span class="remaining-ffe">Rem <span>45</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">140</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$920</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$1050</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                        </div>
                        
                        <!-- D2 Row (Vessel: 400 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D2</span>
                                <span class="dep-etd">ETD W49</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+3%</span>
                                    <span class="remaining-ffe">Rem <span>220</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">180</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$780</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$840</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-3 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+18%</span>
                                    <span class="remaining-ffe">Rem <span>95</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$880</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$980</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-4 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+15%</span>
                                    <span class="remaining-ffe">Rem <span>40</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">145</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$950</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$1120</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge mm">MM</span>
                                </div>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- WTD 2-4 Group -->
                    <div class="wtd-group" data-wtd="WTD 2‚Äì4">
                        <!-- Halo bands for ripple effect -->
                        <div class="halo-band halo-spike"></div>
                        <div class="halo-band halo-removal"></div>
                        <!-- D3 Row (Vessel: 420 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D3</span>
                                <span class="dep-etd">ETD W50</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>280</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">200</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$750</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$800</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+12%</span>
                                    <span class="remaining-ffe">Rem <span>165</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">180</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$820</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$890</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-3 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+10%</span>
                                    <span class="remaining-ffe">Rem <span>110</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">165</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$870</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$950</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-4">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+8%</span>
                                    <span class="remaining-ffe">Rem <span>55</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">150</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$920</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$1040</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge mm">MM</span>
                                </div>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                        </div>
                        
                        <!-- D4 Row (Vessel: 400 FFE, drops to 320 on cap removal) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D4</span>
                                <span class="dep-etd">ETD W51</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">+1%</span>
                                    <span class="remaining-ffe">Rem <span>320</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">180</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$720</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$760</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-2 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+8%</span>
                                    <span class="remaining-ffe">Rem <span>210</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">170</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$780</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$840</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+6%</span>
                                    <span class="remaining-ffe">Rem <span>175</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$800</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$870</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge u">U</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-3">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+5%</span>
                                    <span class="remaining-ffe">Rem <span>125</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">150</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$850</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$920</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-4 event-removal-col">
                                <div class="cell-header">
                                    <span class="bookings-delta negative">-15%</span>
                                    <span class="remaining-ffe">Rem <span>20</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value" style="color: #f87171;">320</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">100</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$1100</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$1350</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge cpm">CPM</span>
                                    <span class="persona-badge mm">MM</span>
                                    <span class="persona-badge onp">ONP</span>
                                </div>
                            </div>
                            <div class="matrix-cell inactive">
                                <span class="sailed-label">Sailed</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- WTD 5-8 Group -->
                    <div class="wtd-group" data-wtd="WTD 5‚Äì8">
                        <!-- Halo bands for ripple effect -->
                        <div class="halo-band halo-spike"></div>
                        <div class="halo-band halo-removal"></div>
                        <!-- D5 Row (Vessel: 380 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D5</span>
                                <span class="dep-etd">ETD W52</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">0%</span>
                                    <span class="remaining-ffe">Rem <span>350</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">170</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$700</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$740</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+4%</span>
                                    <span class="remaining-ffe">Rem <span>290</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">165</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$740</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$790</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2 event-spike-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+3%</span>
                                    <span class="remaining-ffe">Rem <span>245</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$760</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$820</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+4%</span>
                                    <span class="remaining-ffe">Rem <span>200</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">155</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$790</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$860</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge u">U</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-3 event-removal-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+12%</span>
                                    <span class="remaining-ffe">Rem <span>120</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">140</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$880</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$980</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-4">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+9%</span>
                                    <span class="remaining-ffe">Rem <span>65</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">125</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$940</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$1080</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                    <span class="persona-badge mm">MM</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- D6 Row (Vessel: 400 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D6</span>
                                <span class="dep-etd">ETD W01 '26</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">0%</span>
                                    <span class="remaining-ffe">Rem <span>380</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">185</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$680</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$720</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>340</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">180</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$700</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$740</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>310</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">175</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$720</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$760</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+3%</span>
                                    <span class="remaining-ffe">Rem <span>265</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">170</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$750</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$800</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2 event-removal-col">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+8%</span>
                                    <span class="remaining-ffe">Rem <span>195</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$800</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$870</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge u">U</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-3">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+6%</span>
                                    <span class="remaining-ffe">Rem <span>140</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">400</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">150</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$850</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$940</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- D7 Row (Vessel: 420 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D7</span>
                                <span class="dep-etd">ETD W02 '26</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">0%</span>
                                    <span class="remaining-ffe">Rem <span>400</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">200</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$650</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$680</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">+1%</span>
                                    <span class="remaining-ffe">Rem <span>385</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">195</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$660</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$690</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">+1%</span>
                                    <span class="remaining-ffe">Rem <span>370</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">190</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$670</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$700</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>350</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">185</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$690</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$720</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge cpm">CPM</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+3%</span>
                                    <span class="remaining-ffe">Rem <span>320</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">180</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$710</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$750</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-2">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>290</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">420</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">175</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$740</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$790</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- D8 Row (Vessel: 380 FFE) -->
                        <div class="matrix-row">
                            <div class="row-spacer"></div>
                            <div class="row-label">
                                <span class="dep-id">D8</span>
                                <span class="dep-etd">ETD W03 '26</span>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">0%</span>
                                    <span class="remaining-ffe">Rem <span>360</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">175</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$640</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$670</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">0%</span>
                                    <span class="remaining-ffe">Rem <span>355</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">172</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$650</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$680</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">+1%</span>
                                    <span class="remaining-ffe">Rem <span>345</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">168</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$660</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$690</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta neutral">+1%</span>
                                    <span class="remaining-ffe">Rem <span>335</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">165</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$670</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$700</span></div>
                                </div>
                                <div class="cell-bottom"></div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>320</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">160</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$690</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$730</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                            <div class="matrix-cell capacity-1">
                                <div class="cell-header">
                                    <span class="bookings-delta positive">+2%</span>
                                    <span class="remaining-ffe">Rem <span>305</span></span>
                                </div>
                                <div class="cell-metrics">
                                    <div class="metric onp"><span class="metric-label">Cap</span> <span class="metric-value">380</span></div>
                                    <div class="metric cpm"><span class="metric-label">Alloc</span> <span class="metric-value">155</span></div>
                                </div>
                                <div class="cell-yields">
                                    <div class="yield utm"><span class="yield-label">NA</span> <span class="yield-value">$710</span></div>
                                    <div class="yield sp"><span class="yield-label">Spot</span> <span class="yield-value">$760</span></div>
                                </div>
                                <div class="cell-bottom">
                                    <span class="persona-badge sp">SP</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- WTD Note -->
                <p class="wtd-note">WTD groups show booking horizon. Autocorrelation comes from substitution/reflow across departures.</p>
            </div>
            
            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Weekly Summary Strip -->
                <div class="weekly-summary">
                    <div class="weekly-summary-title">Weekly Activity Summary</div>
                    <div class="week-stats">
                        <div class="week-stat shock">
                            <div class="week-stat-label">W48‚ÄìW49</div>
                            <div class="week-stat-value">12</div>
                            <div class="week-stat-sub">interventions</div>
                        </div>
                        <div class="week-stat removal">
                            <div class="week-stat-label">W51</div>
                            <div class="week-stat-value">8</div>
                            <div class="week-stat-sub">interventions</div>
                        </div>
                        <div class="week-stat">
                            <div class="week-stat-label">Normal</div>
                            <div class="week-stat-value">4</div>
                            <div class="week-stat-sub">avg/week</div>
                        </div>
                    </div>
                </div>
                
                <!-- Annotations -->
                <div class="annotation spike">
                    <strong>Direct effect</strong>
                    Spike tightens capacity + boosts bookings on near-term departures (D1, D2). Spot CY surges.
                </div>
                
                <div class="annotation">
                    <strong>Halo effect</strong>
                    Substitution/reflow shifts booking pressure to nearby horizons (D3‚ÄìD5). CPM curtails allocations.
                </div>
                
                <div class="annotation removal">
                    <strong>Rework</strong>
                    Capacity removal on D4 W51: All 5 personas intervene. Cap drops 400‚Üí320, Alloc cut to 100.
                </div>
                
                <!-- Legend -->
                <div class="legend">
                    <div class="legend-title">Legend</div>
                    
                    <div class="legend-section">
                        <div class="legend-label">Tokens by Persona</div>
                        <div class="legend-tokens">
                            <div class="token-item">
                                <span class="token-owner onp">ONP</span>
                                <span class="token-desc">Vessel Capacity (Cap)</span>
                            </div>
                            <div class="token-item">
                                <span class="token-owner cpm">CPM</span>
                                <span class="token-desc">Allocated FFE (Alloc)</span>
                            </div>
                            <div class="token-item">
                                <span class="token-owner utm">U</span>
                                <span class="token-desc">Non-Alloc CY/FFE (NA)</span>
                            </div>
                            <div class="token-item">
                                <span class="token-owner sp">SP</span>
                                <span class="token-desc">Spot CY/FFE (Spot)</span>
                            </div>
                            <div class="token-item">
                                <span class="token-owner joint">SP/U</span>
                                <span class="token-desc">Remaining FFE (Rem)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-label">Capacity Tightness</div>
                        <div class="legend-items">
                            <div class="legend-item">
                                <div class="legend-color cap-1"></div>
                                <span>Plenty (>250 FFE)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color cap-2"></div>
                                <span>Normal (150‚Äì250)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color cap-3"></div>
                                <span>Filling (75‚Äì150)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color cap-4"></div>
                                <span>Tight (&lt;75 FFE)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-label">Personas</div>
                        <div class="legend-badges">
                            <div class="legend-badge-item">
                                <span class="persona-badge sp">SP</span>
                                <span>Spot</span>
                            </div>
                            <div class="legend-badge-item">
                                <span class="persona-badge u">U</span>
                                <span>Uptake</span>
                            </div>
                            <div class="legend-badge-item">
                                <span class="persona-badge cpm">CPM</span>
                                <span>Contract</span>
                            </div>
                            <div class="legend-badge-item">
                                <span class="persona-badge mm">MM</span>
                                <span>Market</span>
                            </div>
                            <div class="legend-badge-item">
                                <span class="persona-badge onp">ONP</span>
                                <span>Network</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-label">Events</div>
                        <div class="legend-items">
                            <div class="legend-item">
                                <div class="legend-color event-spike"></div>
                                <span>Booking spike</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color event-removal"></div>
                                <span>Capacity removal</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Mode toggle functionality
        function setMode(mode) {
            const frame = document.getElementById('mainFrame');
            const buttons = document.querySelectorAll('.mode-btn');
            
            if (mode === 'exec') {
                frame.classList.add('exec-mode');
            } else {
                frame.classList.remove('exec-mode');
            }
            
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if ((mode === 'exec' && btn.textContent === 'Executive') ||
                    (mode === 'detail' && btn.textContent === 'Detail')) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Add tooltips to cells for executive mode
        document.querySelectorAll('.matrix-cell:not(.inactive)').forEach(cell => {
            const metrics = cell.querySelector('.cell-metrics');
            const yields = cell.querySelector('.cell-yields');
            
            if (metrics && yields) {
                const capValue = metrics.querySelector('.metric.onp .metric-value')?.textContent || '‚Äî';
                const allocValue = metrics.querySelector('.metric.cpm .metric-value')?.textContent || '‚Äî';
                const naValue = yields.querySelector('.yield.utm .yield-value')?.textContent || '‚Äî';
                const spotValue = yields.querySelector('.yield.sp .yield-value')?.textContent || '‚Äî';
                
                const tooltip = document.createElement('div');
                tooltip.className = 'cell-tooltip';
                tooltip.innerHTML = `
                    <div class="tooltip-row">
                        <span class="tooltip-label">Vessel Cap:</span>
                        <span class="tooltip-value onp">${capValue} FFE</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Allocated:</span>
                        <span class="tooltip-value cpm">${allocValue} FFE</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Non-Alloc CY:</span>
                        <span class="tooltip-value utm">${naValue}</span>
                    </div>
                    <div class="tooltip-row">
                        <span class="tooltip-label">Spot CY:</span>
                        <span class="tooltip-value sp">${spotValue}</span>
                    </div>
                `;
                cell.appendChild(tooltip);
            }
        });
    </script>
</body>
</html>
